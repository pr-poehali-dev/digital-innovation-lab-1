import { Navbar } from "@/components/navbar"
import { Footer } from "@/components/footer"
import { Badge } from "@/components/ui/badge"
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card"
import { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from "@/components/ui/accordion"

const chapters = [
  {
    id: "what-is-bot",
    badge: "Глава 1",
    title: "Что такое торговый бот и как он работает",
    summary: "Торговый бот — программа, которая автоматически исполняет сделки по заранее заданной логике. Он не спит, не устаёт и не поддаётся эмоциям.",
    sections: [
      {
        title: "Принцип работы бота",
        content: "Бот подключается к бирже через API (Application Programming Interface) — программный интерфейс, который позволяет отправлять ордера и получать данные. Алгоритм анализирует рыночные данные (цена, объём, индикаторы), принимает решение по логике стратегии, отправляет ордер через API. Всё это происходит за миллисекунды без участия человека."
      },
      {
        title: "API-ключи: как подключить бота к бирже",
        content: "Биржа выдаёт API-ключ (публичный) и Secret (приватный). Публичный идентифицирует вас, приватный подписывает запросы. НИКОГДА не давайте Secret третьим лицам — это равно передаче пароля. Создавайте ключи с ограниченными правами: только торговля, без вывода средств. Регулярно меняйте ключи."
      },
      {
        title: "Преимущества и ограничения",
        content: "Преимущества: работа 24/7, отсутствие эмоций, молниеносное исполнение, возможность тестировать стратегии на истории. Ограничения: бот исполняет только то, что заложено в код — он не понимает новостей, форс-мажоров, изменений рынка. Плохая стратегия + бот = быстрый слив. Бот усиливает вашу стратегию, а не заменяет её."
      },
    ]
  },
  {
    id: "strategies",
    badge: "Глава 2",
    title: "Популярные стратегии для ботов",
    summary: "Стратегия — сердце любого бота. Рассмотрим самые распространённые алгоритмические стратегии с их логикой, плюсами и минусами.",
    sections: [
      {
        title: "Grid-бот (сеточная торговля)",
        content: "Логика: расставляет ордера на покупку и продажу через равные интервалы цены — «сетку». Когда цена колеблется внутри диапазона, бот постоянно покупает дёшево и продаёт дороже. Плюсы: хорошо работает в боковике, простая реализация. Минусы: при сильном тренде вниз накапливает убыточные позиции. Идеален для волатильных активов без явного тренда."
      },
      {
        title: "DCA-бот (усреднение)",
        content: "Логика: покупает актив через равные промежутки времени или при падении цены на X%. Снижает среднюю цену покупки при падении. Плюсы: прост в настройке, подходит для долгосрочного накопления, снижает влияние точки входа. Минусы: при затяжном медвежьем рынке замораживает большой капитал. Лучше всего — для накопления Bitcoin или ETH."
      },
      {
        title: "Арбитражный бот",
        content: "Логика: использует разницу цен одного актива на разных биржах или торговых парах. Покупает дешевле на одной площадке, продаёт дороже на другой. Плюсы: теоретически безрисковая прибыль, не зависит от направления рынка. Минусы: возможности быстро закрываются, требует высокой скорости, сложная инфраструктура, высокие комиссии сводят прибыль к нулю."
      },
      {
        title: "Трендовый бот (следование тренду)",
        content: "Логика: отслеживает индикаторы тренда (EMA, MACD, Supertrend), входит в направлении тренда и выходит при смене сигнала. Плюсы: хорошо работает на трендовых рынках, понятная логика. Минусы: множество ложных сигналов в боковике, запаздывание индикаторов. Часто используется с фильтром объёма для повышения точности."
      },
      {
        title: "Скальпинг-бот",
        content: "Логика: совершает десятки–сотни мелких сделок в день, забирая небольшую прибыль с каждой (0.1–0.5%). Работает на самых коротких тайм-фреймах (M1–M5). Плюсы: много сделок → статистическое преимущество, быстрая проверка стратегии. Минусы: очень чувствителен к комиссиям и спреду, требует co-location или быстрого VPS. Не подходит для новичков."
      },
    ]
  },
  {
    id: "backtesting",
    badge: "Глава 3",
    title: "Бэктестинг: проверка стратегии на истории",
    summary: "Прежде чем запускать бота с реальными деньгами, нужно проверить стратегию на исторических данных. Это называется бэктестинг.",
    sections: [
      {
        title: "Что такое бэктестинг и зачем он нужен",
        content: "Бэктестинг — симуляция работы стратегии на исторических данных. Вы «запускаете» бота в прошлое и смотрите, как бы он торговал. Ключевые метрики: Total Return (общая доходность), Max Drawdown (максимальная просадка), Sharpe Ratio (доходность с учётом риска), Win Rate (процент прибыльных сделок), Profit Factor (отношение суммы прибылей к убыткам)."
      },
      {
        title: "Опасности бэктестинга: overfitting",
        content: "Overfitting (переобучение) — когда стратегия идеально работает на исторических данных, но провалится в реальности. Происходит при слишком большом количестве параметров, подобранных под конкретные данные. Признаки: нереально высокая доходность (>200% в год), идеальные точки входа/выхода, стратегия работает только на одном активе. Решение: тестировать на данных, которые не использовались при оптимизации (out-of-sample test)."
      },
      {
        title: "Инструменты для бэктестинга",
        content: "TradingView Pine Script — встроенный бэктестинг прямо на графике, подходит для начала. Python + Backtrader / Backtesting.py — гибкие библиотеки для сложных стратегий. Freqtrade — open-source фреймворк для крипто-ботов с встроенным бэктестингом. Finrl — для ботов на основе машинного обучения. После бэктестинга обязателен paper trading (торговля на виртуальные деньги в реальном времени)."
      },
    ]
  },
  {
    id: "platforms",
    badge: "Глава 4",
    title: "Платформы для создания ботов без кода",
    summary: "Не умеете программировать? Это не проблема. Существуют no-code платформы, позволяющие создавать ботов через визуальный интерфейс.",
    sections: [
      {
        title: "3Commas",
        content: "Одна из самых популярных платформ. Готовые боты: DCA, Grid, Options. Подключается к 20+ биржам. Есть маркетплейс стратегий — можно скопировать бота от другого трейдера. Платная подписка от $29/мес. Минус — сторонний сервис хранит ваши API-ключи, что несёт риск при взломе платформы."
      },
      {
        title: "Pionex",
        content: "Биржа со встроенными ботами — не нужны API-ключи. 16 бесплатных типов ботов: Grid, DCA, TWAP, Arbitrage и другие. Комиссия 0.05% — одна из самых низких. Идеально для новичков: простой интерфейс, нет технических сложностей. Ограничение — только свои торговые пары."
      },
      {
        title: "Freqtrade (open-source)",
        content: "Бесплатный open-source фреймворк для крипто-ботов. Требует базовых знаний Python и командной строки. Зато полный контроль: ваш бот, ваш сервер, ваши ключи. Встроенный бэктестинг, оптимизация, Telegram-интеграция. Поддерживает все крупные биржи через CCXT. Рекомендуется для тех, кто хочет серьёзно заниматься алгоритмической торговлей."
      },
    ]
  },
  {
    id: "launch",
    badge: "Глава 5",
    title: "Запуск бота: чеклист перед стартом",
    summary: "Перед запуском бота с реальными деньгами пройдите этот чеклист. Пропуск любого пункта может стоить части депозита.",
    sections: [
      {
        title: "Технические проверки",
        content: "✓ Бот протестирован на исторических данных (бэктестинг). ✓ Пройден период paper trading (от 2 недель). ✓ API-ключи созданы без права вывода средств. ✓ Бот запущен на VPS с минимальной задержкой до биржи. ✓ Настроен мониторинг и алерты в Telegram при ошибках. ✓ Настроен автоматический перезапуск при падении процесса."
      },
      {
        title: "Риск-менеджмент для бота",
        content: "✓ Установлен максимальный убыток за день (Daily Stop Loss). ✓ Ограничен максимальный объём одной позиции. ✓ Настроен глобальный стоп при потере X% от депозита. ✓ Запускаете с минимальным капиталом (10–20% от планируемого). ✓ Есть план действий при аномальном поведении рынка (flash crash, делистинг)."
      },
      {
        title: "Мониторинг и обслуживание",
        content: "Бот нужно регулярно проверять — рынок меняется. Ежедневно: смотрите PnL, количество сделок, открытые позиции. Еженедельно: сравнивайте с бэктестом, проверяйте метрики. Ежемесячно: переоптимизируйте параметры при изменении режима рынка. Ведите лог всех сделок бота — это помогает выявить проблемы."
      },
    ]
  },
]

export default function BotsGuide() {
  return (
    <div className="dark min-h-screen bg-black">
      <Navbar />
      <main className="pt-24 pb-20">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
          {/* Header */}
          <div className="text-center mb-16">
            <Badge className="bg-red-500/20 text-red-400 border-red-500/30 mb-4">База знаний</Badge>
            <h1 className="font-orbitron text-4xl md:text-5xl font-bold text-white mb-6">
              Гайд по торговым ботам
            </h1>
            <p className="text-gray-300 text-lg md:text-xl max-w-2xl mx-auto leading-relaxed">
              От понимания принципов работы до запуска первого бота. Стратегии, бэктестинг, платформы и чеклист запуска.
            </p>
          </div>

          {/* Chapter navigation */}
          <div className="flex gap-2 mb-12 flex-wrap justify-center">
            {chapters.map((c) => (
              <a
                key={c.id}
                href={`#${c.id}`}
                className="text-xs font-space-mono text-red-400 border border-red-500/30 px-3 py-1 rounded-full hover:bg-red-500/10 transition-colors"
              >
                {c.badge}
              </a>
            ))}
          </div>

          {/* Chapters */}
          <div className="space-y-12">
            {chapters.map((chapter) => (
              <div key={chapter.id} id={chapter.id} className="scroll-mt-24">
                <Card className="bg-zinc-900 border-red-500/20">
                  <CardHeader className="pb-4">
                    <div className="flex items-center gap-3 mb-3">
                      <Badge className="bg-red-500 text-white border-0">{chapter.badge}</Badge>
                    </div>
                    <CardTitle className="font-orbitron text-2xl text-white leading-tight">
                      {chapter.title}
                    </CardTitle>
                    <p className="text-gray-400 leading-relaxed mt-2">{chapter.summary}</p>
                  </CardHeader>
                  <CardContent>
                    <Accordion type="multiple" className="w-full">
                      {chapter.sections.map((section, idx) => (
                        <AccordionItem
                          key={idx}
                          value={`${chapter.id}-${idx}`}
                          className="border-red-500/20"
                        >
                          <AccordionTrigger className="text-left text-base font-semibold text-white hover:text-red-400 font-orbitron">
                            {section.title}
                          </AccordionTrigger>
                          <AccordionContent className="text-gray-300 leading-relaxed font-space-mono text-sm">
                            {section.content}
                          </AccordionContent>
                        </AccordionItem>
                      ))}
                    </Accordion>
                  </CardContent>
                </Card>
              </div>
            ))}
          </div>

          {/* Next step */}
          <div className="mt-16 text-center">
            <p className="text-gray-400 mb-4 font-space-mono">Хотите создать своего бота прямо сейчас?</p>
            <a
              href="/bot-builder"
              className="inline-block bg-red-500 hover:bg-red-600 text-white font-orbitron px-8 py-3 rounded-md transition-colors"
            >
              Открыть конструктор ботов →
            </a>
          </div>
        </div>
      </main>
      <Footer />
    </div>
  )
}
